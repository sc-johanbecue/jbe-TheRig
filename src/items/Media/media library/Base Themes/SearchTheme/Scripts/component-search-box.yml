---
ID: "84a844f4-4a16-408e-beab-e49d67e4373d"
Parent: "dfcbfa5a-2e37-418a-adb7-f411ecae89a9"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Base Themes/SearchTheme/Scripts/component-search-box"
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/84A844F44A16408EBEABE49D67E4373D.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "84a844f4-4a16-408e-beab-e49d67e4373d"
  Value: LyoqCiAqIFNlYXJjaCBib3ggY29tcG9uZW50IGZ1bmN0aW9uYWxpdHkKICogQG1vZHVsZSBzZWFyY2hCb3gKICogQHBhcmFtICB7alF1ZXJ5fSAkIEluc3RhbmNlIG9mIGpRdWVyeQogKiBAcGFyYW0gIHtEb2N1bWVudH0gZG9jdW1lbnQgZG9tIGRvY3VtZW50IG9iamVjdAogKiBAcmV0dXJuIHtPYmplY3R9IGxpc3Qgb2YgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHNlYXJjaCBib3gKICovClhBLmNvbXBvbmVudC5zZWFyY2guYm94ID0gKGZ1bmN0aW9uICgkLCBkb2N1bWVudCkgewogICAgdmFyIGFwaSA9IHt9LAogICAgICBzZWFyY2hCb3hWaWV3cyA9IFtdLAogICAgICBzZWFyY2hCb3hNb2RlbHMgPSBbXSwKICAgICAgcXVlcnlNb2RlbCwKICAgICAgdXJsSGVscGVyTW9kZWwsCiAgICAgIHNlYXJjaFJlc3VsdE1vZGVsczsKICAgIC8qKgogICAgICogQG5hbWUgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbAogICAgICogQGNvbnN0cnVjdG9yCiAgICAgKiBAYXVnbWVudHMgQmFja2JvbmUuTW9kZWwKICAgICAqLwogICAgdmFyIFNlYXJjaEJveE1vZGVsID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kKAogICAgICAvKiogQGxlbmRzIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94TW9kZWwucHJvdG90eXBlICoqLwogICAgICB7CiAgICAgICAgLyoqCiAgICAgICAgICogRGVmYXVsdCBtb2RlbCBvcHRpb25zCiAgICAgICAgICogQGRlZmF1bHQKICAgICAgICAgKi8KICAgICAgICBkZWZhdWx0czogewogICAgICAgICAgYXV0b2NvbXBsZXRlOiAiIiwKICAgICAgICAgIGRhdGFQcm9wZXJ0aWVzOiB7fSwKICAgICAgICAgIHNlYXJjaFF1ZXJ5OiAiIiwKICAgICAgICAgIGxvYWRpbmdJblByb2dyZXNzOiBmYWxzZSwKICAgICAgICAgIHNpZzogW10sCiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIHVybCBmcm9tIHdoaWNoIHN1Z2dlc3Rpb24gc2hvdWxkIGJlIHRha2VuCiAgICAgICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94TW9kZWwKICAgICAgICAgKiBAbWV0aG9kCiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgbGlzdCBvZiBwcm9wZXJ0aWVzIGZvciBzdWdnZXN0aW9uIGZ1bmN0aW9uYWxpdHkKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VhcmNoUXVlcnkgdGV4dCBmcm9tIHNlYXJjaCBib3gKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbC5jcmVhdGVTdWdnZXN0aW9uc1VybAogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHNlYXJjaCB1cmwgYmFzZWQgb24gc2V0dXBzCiAgICAgICAgICovCiAgICAgICAgY3JlYXRlU3VnZ2VzdGlvbnNVcmw6IGZ1bmN0aW9uIChwcm9wZXJ0aWVzLCBzZWFyY2hRdWVyeSkgewogICAgICAgICAgdmFyIHN1Z2dlc3Rpb25zTW9kZSA9IHRoaXMuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnN1Z2dlc3Rpb25zTW9kZSwKICAgICAgICAgICAgcmVzdWx0c0VuZHBvaW50ID0gdGhpcy5nZXQoImRhdGFQcm9wZXJ0aWVzIikuZW5kcG9pbnQsCiAgICAgICAgICAgIHN1Z2dlc3Rpb25zRW5kcG9pbnQgPSB0aGlzLmdldCgiZGF0YVByb3BlcnRpZXMiKS5zdWdnZXN0aW9uRW5kcG9pbnQ7CiAgCiAgICAgICAgICBzd2l0Y2ggKHN1Z2dlc3Rpb25zTW9kZSkgewogICAgICAgICAgICBjYXNlICJTaG93UHJlZGljdGlvbnMiOiB7CiAgICAgICAgICAgICAgcmV0dXJuIHVybEhlbHBlck1vZGVsLmNyZWF0ZVByZWRpY3RpdmVTZWFyY2hVcmwoCiAgICAgICAgICAgICAgICBzdWdnZXN0aW9uc0VuZHBvaW50LAogICAgICAgICAgICAgICAgcHJvcGVydGllcywKICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkZWZhdWx0OiB7CiAgICAgICAgICAgICAgcmV0dXJuIHVybEhlbHBlck1vZGVsLmNyZWF0ZVByZWRpY3RpdmVTZWFyY2hVcmwoCiAgICAgICAgICAgICAgICByZXN1bHRzRW5kcG9pbnQsCiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLAogICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBnZXQgc2VhcmNoIGJveCBzaWduYXR1cmUKICAgICAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbC5nZXRTaWduYXR1cmUKICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBzZWFyY2ggYm94IHNpZ25hdHVyZQogICAgICAgICAqLwogICAgICAgIGdldFNpZ25hdHVyZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHJhd1NpZ25hdHVyZSA9IHRoaXMuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUsCiAgICAgICAgICAgIHNpZ25hdHVyZXM7CiAgCiAgICAgICAgICBpZiAodHlwZW9mIHJhd1NpZ25hdHVyZSA9PT0gInVuZGVmaW5lZCIgfHwgcmF3U2lnbmF0dXJlID09PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgIH0KICAKICAgICAgICAgIHNpZ25hdHVyZXMgPSByYXdTaWduYXR1cmUuc3BsaXQoIiwiKTsKICAKICAgICAgICAgIGlmIChyYXdTaWduYXR1cmUgPT09ICIiKSB7CiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBzaWduYXR1cmVzWzBdOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogZ2V0IHNlYXJjaCBib3ggbGFuZ3VhZ2UKICAgICAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hNb2RlbC5nZXRMYW5ndWFnZQogICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHNlbGVjdGVkIGxhbmd1YWdlCiAgICAgICAgICovCiAgICAgICAgZ2V0TGFuZ3VhZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBkYXRhUHJvcGVydGllcyA9IHRoaXMuZ2V0KCJkYXRhUHJvcGVydGllcyIpLAogICAgICAgICAgICBzZWFyY2hSZXN1bHRNb2RlbHMgPSBYQS5jb21wb25lbnQuc2VhcmNoLnJlc3VsdHMuc2VhcmNoUmVzdWx0TW9kZWxzLAogICAgICAgICAgICBsYW5ndWFnZVNvdXJjZSA9IGRhdGFQcm9wZXJ0aWVzLmxhbmd1YWdlU291cmNlLAogICAgICAgICAgICBzaWduYXR1cmUgPSB0aGlzLmdldFNpZ25hdHVyZSgpLAogICAgICAgICAgICBtb2RlbDsKICAKICAgICAgICAgIHN3aXRjaCAobGFuZ3VhZ2VTb3VyY2UpIHsKICAgICAgICAgICAgY2FzZSAiQ3VycmVudExhbmd1YWdlIjoKICAgICAgICAgICAgY2FzZSAiQWxsTGFuZ3VhZ2VzIjogewogICAgICAgICAgICAgIHJldHVybiBkYXRhUHJvcGVydGllcy5sOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICBtb2RlbCA9IHNlYXJjaFJlc3VsdE1vZGVscy5maWx0ZXIoZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmdldCgiZGF0YVByb3BlcnRpZXMiKS5zaWcgPT09IHNpZ25hdHVyZTsKICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIG1vZGVsICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgcmV0dXJuIG1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKS5sOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogIAogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0sCiAgICAgIH0KICAgICk7CiAgICAvKioKICAgICAqIEBuYW1lIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICogQGNvbnN0cnVjdG9yCiAgICAgKiBAYXVnbWVudHMgQmFja2JvbmUuVmlldwogICAgICovCiAgICB2YXIgU2VhcmNoQm94VmlldyA9IFhBLmNvbXBvbmVudC5zZWFyY2guYmFzZVZpZXcuZXh0ZW5kKAogICAgICAvKiogQGxlbmRzIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94Vmlldy5wcm90b3R5cGUgKiovCiAgICAgIHsKICAgICAgICAvKioKICAgICAgICAgKkluaXRpYWxpemVzIHR5cGVhaGVhZCBmb3Igdmlldywgc2V0cyB1cCB3YXRjaGVycyBmb3IgY2hhbmdlIG9uIG1vZGVsCiAgICAgICAgICphbmQgY2FsbCBbImluaXRTZWFyY2hFbmdpbmUiXQogICAgICAgICAqIEBtZW1iZXJvZiBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcucHJvdG90eXBlCiAgICAgICAgICovCiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGluc3QgPSB0aGlzLAogICAgICAgICAgICBzaXRlTmFtZSA9IFhBLmNvbXBvbmVudC5zZWFyY2guYWpheC5nZXRQcmFtZXRlckJ5TmFtZSgic2Nfc2l0ZSIpLAogICAgICAgICAgICBkYXRhUHJvcGVydGllcyA9IHRoaXMuJGVsLmRhdGEoKSwKICAgICAgICAgICAgYXV0b2NvbXBsZXRlOwogIAogICAgICAgICAgZGF0YVByb3BlcnRpZXMucHJvcGVydGllcy50YXJnZXRTaWduYXR1cmUgPQogICAgICAgICAgICBkYXRhUHJvcGVydGllcy5wcm9wZXJ0aWVzLnRhcmdldFNpZ25hdHVyZSAhPT0gbnVsbAogICAgICAgICAgICAgID8gZGF0YVByb3BlcnRpZXMucHJvcGVydGllcy50YXJnZXRTaWduYXR1cmUKICAgICAgICAgICAgICA6ICIiOwogIAogICAgICAgICAgdGhpcy5tb2RlbC5zZXQoeyBkYXRhUHJvcGVydGllczogZGF0YVByb3BlcnRpZXMucHJvcGVydGllcyB9KTsKICAgICAgICAgIHRoaXMubW9kZWwuc2V0KAogICAgICAgICAgICAic2lnIiwKICAgICAgICAgICAgdGhpcy50cmFuc2xhdGVTaWduYXR1cmVzKAogICAgICAgICAgICAgIGRhdGFQcm9wZXJ0aWVzLnByb3BlcnRpZXMuc2VhcmNoUmVzdWx0c1NpZ25hdHVyZSwKICAgICAgICAgICAgICAicSIKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMubW9kZWwub24oImNoYW5nZTpsb2FkaW5nSW5Qcm9ncmVzcyIsIHRoaXMubG9hZGluZywgdGhpcyk7CiAgCiAgICAgICAgICBhdXRvY29tcGxldGUgPSBuZXcgYXV0b0NvbXBsZXRlKHsKICAgICAgICAgICAgc2VsZWN0b3I6ICgpID0+IHRoaXMuJGVsLmZpbmQoIi5zZWFyY2gtYm94LWlucHV0IilbMF0sCiAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICBzcmM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGluc3QubW9kZWwuc2V0KHsgbG9hZGluZ0luUHJvZ3Jlc3M6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IHVybEhlbHBlck1vZGVsLmNyZWF0ZVNpdGVVcmwoCiAgICAgICAgICAgICAgICAgICAgaW5zdC5tb2RlbC5jcmVhdGVTdWdnZXN0aW9uc1VybCgKICAgICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKAogICAgICAgICAgICAgICAgICAgICAgICB7IGw6IGluc3QubW9kZWwuZ2V0TGFuZ3VhZ2UoKSB9LAogICAgICAgICAgICAgICAgICAgICAgICBpbnN0Lm1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKQogICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgIGluc3QubW9kZWwuZ2V0KCJzZWFyY2hRdWVyeSIpCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBzaXRlTmFtZQogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICByZXR1cm4gZmV0Y2godXJsKQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoc291cmNlKSB7IHJldHVybiBzb3VyY2UuanNvbigpOyB9KQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgaW5zdC5tb2RlbC5zZXQoeyBsb2FkaW5nSW5Qcm9ncmVzczogZmFsc2UgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5SZXN1bHRzOyAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGtleXM6IFsiSHRtbCJdLAogICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgICAgICBmaWx0ZXI6IChxdWVyeSkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIF8ubWFwKHF1ZXJ5LCAoaXRlbSkgPT4gKHsKICAgICAgICAgICAgICAgICAga2V5OiBpdGVtLmtleSwKICAgICAgICAgICAgICAgICAgbWF0Y2g6IGl0ZW0ubWF0Y2gsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiB7CiAgICAgICAgICAgICAgICAgICAgaHRtbDogaXRlbS52YWx1ZS5IdG1sLAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRocmVzaG9sZDoKICAgICAgICAgICAgICBkYXRhUHJvcGVydGllcy5wcm9wZXJ0aWVzLm1pblN1Z2dlc3Rpb25zVHJpZ2dlckNoYXJhY3RlckNvdW50LAogICAgICAgICAgICBzZWFyY2hFbmdpbmU6ICJsb29zZSIsCiAgICAgICAgICAgIHJlc3VsdHNMaXN0OiB7CiAgICAgICAgICAgICAgdGFnOiAiZGl2IiwKICAgICAgICAgICAgICBjbGFzczogImF1dG9jb21wbGV0ZS1tZW51IGF1dG9jb21wbGV0ZS1tZW51X19hYnNvbHV0ZSIsCiAgICAgICAgICAgICAgZGVzdGluYXRpb246ICgpID0+IHRoaXMuJGVsLmZpbmQoIi5zZWFyY2gtYm94LWlucHV0IilbMF0sCiAgICAgICAgICAgICAgbWF4UmVzdWx0czogaW5zdC5tb2RlbC5nZXQoImRhdGFQcm9wZXJ0aWVzIikucCwKICAgICAgICAgICAgICB0YWJTZWxlY3Q6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICByZXN1bHRJdGVtOiB7CiAgICAgICAgICAgICAgZWxlbWVudDogZnVuY3Rpb24gKGl0ZW0sIGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciBzdWdnZXN0aW9uc01vZGUgPSBkYXRhUHJvcGVydGllcy5wcm9wZXJ0aWVzLnN1Z2dlc3Rpb25zTW9kZSwKICAgICAgICAgICAgICAgICAgdGV4dCA9IGRhdGEgJiYgZGF0YS52YWx1ZSAmJiBkYXRhLnZhbHVlLmh0bWwgPyBkYXRhLnZhbHVlLmh0bWwucmVwbGFjZSgvKDwoW14+XSspPikvZ2ksICIiKSA6ICcnLAogICAgICAgICAgICAgICAgICBzdWdnZXN0aW9uVGV4dCA9IHRleHQgIT09ICIiID8gdGV4dCA6IChkYXRhICYmIGRhdGEudmFsdWUgJiYgZGF0YS52YWx1ZS5odG1sKTsKICAKICAgICAgICAgICAgICAgIHN3aXRjaCAoc3VnZ2VzdGlvbnNNb2RlKSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgIlNob3dQcmVkaWN0aW9ucyI6CiAgICAgICAgICAgICAgICAgIGNhc2UgIlNob3dTZWFyY2hSZXN1bHRzQXNQcmVkaWN0aW9ucyI6IHsKICAgICAgICAgICAgICAgICAgICBpdGVtLmlubmVyVGV4dCA9IHN1Z2dlc3Rpb25UZXh0OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICBpdGVtLmlubmVySHRtbCA9IGRhdGEuaHRtbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdGFnOiAic3BhbiIsCiAgICAgICAgICAgICAgY2xhc3M6CiAgICAgICAgICAgICAgICAic3VnZXNzdGlvbi1pdGVtIGF1dG9jb21wbGV0ZS1zdWdnZXN0aW9uIGF1dG9jb21wbGV0ZS1zZWxlY3RhYmxlIiwKICAgICAgICAgICAgICBzZWxlY3RlZDogImF1dG9jb21wbGV0ZS1jdXJzb3IiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBldmVudHM6IHsKICAgICAgICAgICAgICBpbnB1dDogewogICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaWYgKGF1dG9jb21wbGV0ZS5pbnB1dC52YWx1ZS5sZW5ndGgpIGF1dG9jb21wbGV0ZS5zdGFydCgpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CiAgCiAgICAgICAgICBhdXRvY29tcGxldGUuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigKICAgICAgICAgICAgInNlbGVjdGlvbiIsCiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblNlbGVjdGVkLmJpbmQoaW5zdCkKICAgICAgICAgICk7CiAgCiAgICAgICAgICAvL1RPRE86IFNlZW1zIGxpa2UgYmVsbG93IGxpbmUgaXNuJ3QgbmVlZGVkIGFzIHVwZGF0ZVNlYXJjaEJveFZhbHVlKCkgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZW5kIHdoZW4gaGFzaCB3aWxsIGNoYW5nZSAtIHRvIGJlIHRlc3RlZCBpbiBub24vbXVsdGkgc2lnbmF0dXJlcyBjYXNlcwogICAgICAgICAgLy8gJHNlYXJjaEJveC52YWwoaGFzaE9ialt0aGlzLm1vZGVsLmdldCgic2lnIildICE9PSB1bmRlZmluZWQgPyBoYXNoT2JqW3RoaXMubW9kZWwuZ2V0KCJzaWciKV0gOiAiIik7CiAgCiAgICAgICAgICB0aGlzLm1vZGVsLnNldCh7IGF1dG9jb21wbGV0ZSB9KTsKICAgICAgICAgIHRoaXMubW9kZWwuc2V0KHsKICAgICAgICAgICAgdmFsdWVQcm92aWRlcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBpbnN0LiRlbC5maW5kKCIuc2VhcmNoLWJveC1pbnB1dCIpLnZhbCgpOwogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CiAgICAgICAgICBYQS5jb21wb25lbnQuc2VhcmNoLnZlbnQub24oCiAgICAgICAgICAgICJoYXNoQ2hhbmdlZCIsCiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoQm94VmFsdWUuYmluZCh0aGlzKQogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIGxpc3Qgb2YgZXZlbnRzIGZvciBCYWNrYm9uZSBWaWV3CiAgICAgICAgICogQG1lbWJlcm9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcjZXZlbnRzCiAgICAgICAgICovCiAgICAgICAgZXZlbnRzOiB7CiAgICAgICAgICAiY2xpY2sgLnNlYXJjaC1ib3gtYnV0dG9uIjogInVwZGF0ZVF1ZXJ5TW9kZWxDbGljayIsCiAgICAgICAgICAiY2xpY2sgLnNlYXJjaC1ib3gtYnV0dG9uLXdpdGgtcmVkaXJlY3QiOiAidXBkYXRlUXVlcnlXaXRoUmVkaXJlY3QiLAogICAgICAgICAgImtleXByZXNzIC5zZWFyY2gtYm94LWlucHV0IjogInByZWRpY3RpdmVTZWFyY2giLAogICAgICAgICAgImtleWRvd24gLnNlYXJjaC1ib3gtaW5wdXQiOiAicHJlZGljdGl2ZVNlYXJjaCIsCiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBUb2dnbGUgY3NzIGNsYXNzICJsb2FkaW5nLWluLXByb2dyZXNzIgogICAgICAgICAqIEBtZW1iZXJvZiBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3I2xvYWRpbmcKICAgICAgICAgKi8KICAgICAgICBsb2FkaW5nOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aGlzLiRlbC50b2dnbGVDbGFzcygibG9hZGluZy1pbi1wcm9ncmVzcyIpOwogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogQ2FsbGVkIHdoZW4gc2VsZWN0ZWQgdmFsdWUgZnJvbSBzZWFyY2ggYm94IGFuZCBjYWxsCiAgICAgICAgICogWyJwZXJmb3JtU2VhcmNoIl17QGxpbmsgbW9kdWxlOnBlcmZvcm1TZWFyY2h9IG9yIHJlCiAgICAgICAgICogQG1lbWJlcm9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5PEV2ZW50Pn0gZXZlbnQgalF1ZXJ5IGV2ZW50IG9iamVjdAogICAgICAgICAqIEBwYXJhbSB7RG9tRWxlbWVudH0gZGF0YSBET00gZWxlbWVudCB0aGF0IHdhcyBzZWxlY3RlZAogICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcjc3VnZ2VzdGlvblNlbGVjdGVkCiAgICAgICAgICovCiAgICAgICAgc3VnZ2VzdGlvblNlbGVjdGVkOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgCiAgICAgICAgICB2YXIgZGF0YSA9IGV2ZW50ICYmIGV2ZW50LmRldGFpbCAmJiBldmVudC5kZXRhaWwuc2VsZWN0aW9uICYmIGV2ZW50LmRldGFpbC5zZWxlY3Rpb24udmFsdWU7CiAgICAgICAgICB2YXIgc3VnZ2VzdGlvbnNNb2RlID0gdGhpcy5tb2RlbC5nZXQoImRhdGFQcm9wZXJ0aWVzIikuc3VnZ2VzdGlvbnNNb2RlOwogICAgICAgICAgdmFyIHRleHQ7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICB0ZXh0ID0gJChkYXRhLmh0bWwpLnRleHQoKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIHRleHQgPSAiIjsKICAgICAgICAgIH0KICAKICAgICAgICAgIHZhciBzdWdnZXN0aW9uVGV4dCA9IHRleHQgIT0gIiIgPyB0ZXh0IDogZGF0YS5odG1sLAogICAgICAgICAgICBsaW5rOwogIAogICAgICAgICAgc3dpdGNoIChzdWdnZXN0aW9uc01vZGUpIHsKICAgICAgICAgICAgY2FzZSAiU2hvd1ByZWRpY3Rpb25zIjoKICAgICAgICAgICAgY2FzZSAiU2hvd1NlYXJjaFJlc3VsdHNBc1ByZWRpY3Rpb25zIjogewogICAgICAgICAgICAgIHRoaXMucGVyZm9ybVNlYXJjaChzdWdnZXN0aW9uVGV4dCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgIGxpbmsgPSAkKGRhdGEuaHRtbCkuZmluZCgiYSIpOwogICAgICAgICAgICAgIGlmIChsaW5rLmxlbmd0aCkgewogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAkKGxpbmtbMF0pLmF0dHIoImhyZWYiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIFVwZGF0ZXMgaGFzaCB2YWx1ZSBhbmQgbWFrZXMgcmVkaXJlY3QgYmFzZWQgb24gdmFsdWUgZnJvbSBzZWFyY2ggYm94CiAgICAgICAgICogQG1lbWJlcm9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5PEV2ZW50Pn0gZXZlbnQgalF1ZXJ5IGV2ZW50IG9iamVjdAogICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcjdXBkYXRlUXVlcnlXaXRoUmVkaXJlY3QKICAgICAgICAgKi8KICAgICAgICB1cGRhdGVRdWVyeVdpdGhSZWRpcmVjdDogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogIAogICAgICAgICAgdmFyIHJlc3VsdFBhZ2UgPSB0aGlzLm1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKS5yZXN1bHRQYWdlLAogICAgICAgICAgICB0YXJnZXRTaWduYXR1cmUgPSB0aGlzLm1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKS50YXJnZXRTaWduYXR1cmUsCiAgICAgICAgICAgIHNlYXJjaFJlc3VsdHNTaWduYXR1cmUgPQogICAgICAgICAgICAgIHRoaXMubW9kZWwuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUsCiAgICAgICAgICAgIHF1ZXJ5ID0gZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuJGVsLmZpbmQoIi5zZWFyY2gtYm94LWlucHV0IikudmFsKCkpLAogICAgICAgICAgICBzaWcgPSB0aGlzLm1vZGVsLmdldCgic2lnIiksCiAgICAgICAgICAgIHF1ZXJ5V2l0aFNpZ25hdHVyZSA9IHt9OwogIAogICAgICAgICAgaWYgKHRhcmdldFNpZ25hdHVyZSAhPT0gIiIpIHsKICAgICAgICAgICAgcXVlcnlXaXRoU2lnbmF0dXJlID0gdGhpcy51cGRhdGVTaWduYXR1cmVzSGFzaCgKICAgICAgICAgICAgICBbdGFyZ2V0U2lnbmF0dXJlICsgIl9xIl0sCiAgICAgICAgICAgICAgcXVlcnksCiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVPZmZzZXRPYmplY3QoKQogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcXVlcnlXaXRoU2lnbmF0dXJlID0gdGhpcy51cGRhdGVTaWduYXR1cmVzSGFzaCgKICAgICAgICAgICAgICBzaWcsCiAgICAgICAgICAgICAgcXVlcnksCiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVPZmZzZXRPYmplY3QoKQogICAgICAgICAgICApOwogICAgICAgICAgfQogIAogICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmxIZWxwZXJNb2RlbC5jcmVhdGVSZWRpcmVjdFNlYXJjaFVybCgKICAgICAgICAgICAgcmVzdWx0UGFnZSwKICAgICAgICAgICAgcXVlcnlXaXRoU2lnbmF0dXJlLAogICAgICAgICAgICBzZWFyY2hSZXN1bHRzU2lnbmF0dXJlLAogICAgICAgICAgICB0YXJnZXRTaWduYXR1cmUKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBUYWtlcyBzZWFyY2ggYm94IHZhbHVlIGFzIGEgcXVlcnkgdmFsdWUgYW5kIGNhbGxzCiAgICAgICAgICogWyJ1cGRhdGVRdWVyeU1vZGVsIl17QGxpbmsgbW9kdWxlOm1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldyN1cGRhdGVRdWVyeU1vZGVsfQogICAgICAgICAqIEBtZW1iZXJvZiBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcKICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeTxFdmVudD59IGV2ZW50IGpRdWVyeSBldmVudCBvYmplY3QKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3I3VwZGF0ZVF1ZXJ5TW9kZWxDbGljawogICAgICAgICAqLwogICAgICAgIHVwZGF0ZVF1ZXJ5TW9kZWxDbGljazogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogIAogICAgICAgICAgWEEuY29tcG9uZW50LnNlYXJjaC52ZW50LnRyaWdnZXIoIm5ldy1zZWFyY2giKTsKICAKICAgICAgICAgIHZhciBxdWVyeSA9IHRoaXMuJGVsLmZpbmQoIi5zZWFyY2gtYm94LWlucHV0IikudmFsKCk7CiAgICAgICAgICB0aGlzLmNsb3NlRHJvcGRvd24oKTsKICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnlNb2RlbChxdWVyeSk7CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBVcGRhdGVzIGhhc2ggYmFzZWQgb24gc2VhcmNoVmFsdWUKICAgICAgICAgKiBAbWVtYmVyb2YgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3CiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHF1ZXJ5IGpRdWVyeSBldmVudCBvYmplY3QKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3I3VwZGF0ZVF1ZXJ5TW9kZWwKICAgICAgICAgKi8KICAgICAgICB1cGRhdGVRdWVyeU1vZGVsOiBmdW5jdGlvbiAocXVlcnkpIHsKICAgICAgICAgIHZhciBzZWFyY2hWYWx1ZSA9IHt9LAogICAgICAgICAgICBvZmZzZXRTaWduYXR1cmVzID0gdGhpcy50cmFuc2xhdGVTaWduYXR1cmVzKAogICAgICAgICAgICAgIHRoaXMubW9kZWwuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnNlYXJjaFJlc3VsdHNTaWduYXR1cmUsCiAgICAgICAgICAgICAgImUiCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHNpZyA9IHRoaXMubW9kZWwuZ2V0KCJzaWciKSwKICAgICAgICAgICAgaTsKICAKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzaWcubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc2VhcmNoVmFsdWVbc2lnW2ldXSA9IHF1ZXJ5OwogICAgICAgICAgICBzZWFyY2hWYWx1ZVtvZmZzZXRTaWduYXR1cmVzW2ldXSA9IDA7CiAgICAgICAgICB9CiAgCiAgICAgICAgICBxdWVyeU1vZGVsLnVwZGF0ZUhhc2goCiAgICAgICAgICAgIHNlYXJjaFZhbHVlLAogICAgICAgICAgICB0aGlzLm1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKS50YXJnZXRVcmwKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBDYWxscyBbInBlcmZvcm1TZWFyY2giXXtAbGluayBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcjcGVyZm9ybVNlYXJjaH0KICAgICAgICAgKiBieSBwcmVzc2luZyBFbnRlciBrZXkKICAgICAgICAgKiBAbWVtYmVyb2YgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3CiAgICAgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgRXZlbnQgb2JqZWN0CiAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldyNwcmVkaWN0aXZlU2VhcmNoCiAgICAgICAgICovCiAgICAgICAgcHJlZGljdGl2ZVNlYXJjaDogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdGhpcy5wZXJmb3JtU2VhcmNoKHRoaXMuJGVsLmZpbmQoIi5zZWFyY2gtYm94LWlucHV0IikudmFsKCkpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogTWFrZXMgc2VhcmNoCiAgICAgICAgICogQG1lbWJlcm9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBxdWVyeSB2YWx1ZSBmcm9tIHNlYXJjaCBib3gKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3I3BlcmZvcm1TZWFyY2gKICAgICAgICAgKi8KICAgICAgICBwZXJmb3JtU2VhcmNoOiBmdW5jdGlvbiAocXVlcnkpIHsKICAgICAgICAgIHZhciBwcm9wZXJ0aWVzID0gdGhpcy5tb2RlbC5nZXQoImRhdGFQcm9wZXJ0aWVzIiksCiAgICAgICAgICAgIHRhcmdldFNpZ25hdHVyZSA9IHByb3BlcnRpZXMudGFyZ2V0U2lnbmF0dXJlLAogICAgICAgICAgICBzZWFyY2hSZXN1bHRzU2lnbmF0dXJlID0gcHJvcGVydGllcy5zZWFyY2hSZXN1bHRzU2lnbmF0dXJlLAogICAgICAgICAgICByZXN1bHRQYWdlID0gcHJvcGVydGllcy5yZXN1bHRQYWdlLAogICAgICAgICAgICBzaWcgPSB0aGlzLm1vZGVsLmdldCgic2lnIiksCiAgICAgICAgICAgIHF1ZXJ5V2l0aFNpZ25hdHVyZSA9IHt9OwogIAogICAgICAgICAgWEEuY29tcG9uZW50LnNlYXJjaC52ZW50LnRyaWdnZXIoIm5ldy1zZWFyY2giKTsKICAKICAgICAgICAgIHRoaXMuY2xvc2VEcm9wZG93bigpOwogICAgICAgICAgdGhpcy4kZWwuZmluZCgiLnNlYXJjaC1ib3gtaW5wdXQiKS52YWwocXVlcnkpOwogIAogICAgICAgICAgaWYgKHJlc3VsdFBhZ2UgPT09ICIiKSB7CiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnlNb2RlbChxdWVyeSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBxdWVyeSA9IGVuY29kZVVSSUNvbXBvbmVudChxdWVyeSk7CiAgICAgICAgICAgIGlmICh0YXJnZXRTaWduYXR1cmUgIT09ICIiKSB7CiAgICAgICAgICAgICAgcXVlcnlXaXRoU2lnbmF0dXJlID0gdGhpcy51cGRhdGVTaWduYXR1cmVzSGFzaCgKICAgICAgICAgICAgICAgIFt0YXJnZXRTaWduYXR1cmUgKyAiX3EiXSwKICAgICAgICAgICAgICAgIHF1ZXJ5LAogICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVPZmZzZXRPYmplY3QoKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcXVlcnlXaXRoU2lnbmF0dXJlID0gdGhpcy51cGRhdGVTaWduYXR1cmVzSGFzaCgKICAgICAgICAgICAgICAgIHNpZywKICAgICAgICAgICAgICAgIHF1ZXJ5LAogICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVPZmZzZXRPYmplY3QoKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmxIZWxwZXJNb2RlbC5jcmVhdGVSZWRpcmVjdFNlYXJjaFVybCgKICAgICAgICAgICAgICByZXN1bHRQYWdlLAogICAgICAgICAgICAgIHF1ZXJ5V2l0aFNpZ25hdHVyZSwKICAgICAgICAgICAgICBzZWFyY2hSZXN1bHRzU2lnbmF0dXJlLAogICAgICAgICAgICAgIHRhcmdldFNpZ25hdHVyZQogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogQ3JlYXRlcyBvYmplY3QgdGhhdCBjb250YWluIHNpZ25hdHVyZXMKICAgICAgICAgKiBAbWVtYmVyb2YgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3CiAgICAgICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldyNjcmVhdGVPZmZzZXRPYmplY3QKICAgICAgICAgKi8KICAgICAgICBjcmVhdGVPZmZzZXRPYmplY3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBzaWcgPSB0aGlzLm1vZGVsLmdldCgic2lnIiksCiAgICAgICAgICAgIHRhcmdldFNpZ25hdHVyZSA9IHRoaXMubW9kZWwuZ2V0KCJkYXRhUHJvcGVydGllcyIpLnRhcmdldFNpZ25hdHVyZSwKICAgICAgICAgICAgc2lnbmF0dXJlID0KICAgICAgICAgICAgICB0YXJnZXRTaWduYXR1cmUgIT09ICIiCiAgICAgICAgICAgICAgICA/IHRhcmdldFNpZ25hdHVyZQogICAgICAgICAgICAgICAgOiB0aGlzLm1vZGVsLmdldCgiZGF0YVByb3BlcnRpZXMiKS5zZWFyY2hSZXN1bHRzU2lnbmF0dXJlLAogICAgICAgICAgICBvZmZzZXRTaWduYXR1cmVzID0gdGhpcy50cmFuc2xhdGVTaWduYXR1cmVzKHNpZ25hdHVyZSwgImUiKSwKICAgICAgICAgICAgb2Zmc2V0T2JqZWN0ID0ge30sCiAgICAgICAgICAgIGk7CiAgCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2lnLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIG9mZnNldE9iamVjdFtvZmZzZXRTaWduYXR1cmVzW2ldXSA9IDA7CiAgICAgICAgICB9CiAgCiAgICAgICAgICByZXR1cm4gb2Zmc2V0T2JqZWN0OwogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogU2V0cyB2YWx1ZSBpbnRvIHNlYXJjaCBib3ggYmFzZWQgb24gaGFzaAogICAgICAgICAqIEBtZW1iZXJvZiBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcKICAgICAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5TZWFyY2hCb3hWaWV3I3VwZGF0ZVNlYXJjaEJveFZhbHVlCiAgICAgICAgICovCiAgICAgICAgdXBkYXRlU2VhcmNoQm94VmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBoYXNoT2JqID0gcXVlcnlNb2RlbC5wYXJzZUhhc2hQYXJhbWV0ZXJzKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSwKICAgICAgICAgICAgZWwgPSB0aGlzLiRlbC5maW5kKCIuc2VhcmNoLWJveC1pbnB1dCIpLAogICAgICAgICAgICBzaWcgPSB0aGlzLm1vZGVsLmdldCgic2lnIiksCiAgICAgICAgICAgIGk7CiAgCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2lnLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChoYXNoT2JqLmhhc093blByb3BlcnR5KHNpZ1tpXSkpIHsKICAgICAgICAgICAgICBlbC52YWwoZGVjb2RlVVJJQ29tcG9uZW50KGhhc2hPYmpbc2lnW2ldXSkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsLnZhbCgiIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIENsb3NlcyB0eXBlYWhlYWQgZHJvcCBkb3duCiAgICAgICAgICogQG1lbWJlcm9mIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94VmlldwogICAgICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveFZpZXcjY2xvc2VEcm9wZG93bgogICAgICAgICAqLwogICAgICAgIGNsb3NlRHJvcGRvd246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoaXMubW9kZWwuZ2V0KCJhdXRvY29tcGxldGUiKS5jbG9zZSgpOwogICAgICAgIH0sCiAgICAgIH0KICAgICk7CiAgICAvKioKICAgICAqIEZvciBlYWNoIHNlYXJjaCBib3ggb24gYSBwYWdlIGNyZWF0ZXMgaW5zdGFuY2Ugb2YKICAgICAqIFsic2VhcmNoQm94TW9kZWwiXXtAbGluayBtb2R1bGU6c2VhcmNoQm94LlNlYXJjaEJveE1vZGVsfSBhbmQKICAgICAqIFsiU2VhcmNoQm94VmlldyJde0BsaW5rIG1vZHVsZTpzZWFyY2hCb3guU2VhcmNoQm94Vmlld30KICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6c2VhcmNoQm94CiAgICAgKiBAYWxpYXMgbW9kdWxlOnNlYXJjaEJveC5pbml0CiAgICAgKi8KICAgIGFwaS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoJCgiYm9keSIpLmhhc0NsYXNzKCJvbi1wYWdlLWVkaXRvciIpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHF1ZXJ5TW9kZWwgPSBYQS5jb21wb25lbnQuc2VhcmNoLnF1ZXJ5OwogICAgICBzZWFyY2hSZXN1bHRNb2RlbHMgPSBYQS5jb21wb25lbnQuc2VhcmNoLnJlc3VsdHMuc2VhcmNoUmVzdWx0TW9kZWxzOwogICAgICB1cmxIZWxwZXJNb2RlbCA9IFhBLmNvbXBvbmVudC5zZWFyY2gudXJsOwogIAogICAgICB2YXIgc2VhcmNoQm94ID0gJCgiLnNlYXJjaC1ib3g6bm90KC5pbml0aWFsaXplZCkiKTsKICAKICAgICAgXy5lYWNoKHNlYXJjaEJveCwgZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICB2YXIgJGVsID0gJChlbGVtKSwKICAgICAgICAgIGJveE1vZGVsID0gbmV3IFNlYXJjaEJveE1vZGVsKCk7CiAgCiAgICAgICAgc2VhcmNoQm94TW9kZWxzLnB1c2goYm94TW9kZWwpOwogICAgICAgIHNlYXJjaEJveFZpZXdzLnB1c2gobmV3IFNlYXJjaEJveFZpZXcoeyBlbDogJGVsLCBtb2RlbDogYm94TW9kZWwgfSkpOwogICAgICAgICRlbC5hZGRDbGFzcygiaW5pdGlhbGl6ZWQiKTsKICAgICAgfSk7CiAgICB9OwogICAgLyoqCiAgICAgKiBFeHRlbmRzIHNlYXJjaCBib3ggQVBJIHdpdGgKICAgICAqIFsic2VhcmNoQm94Vmlld3MiXXtAbGluayBtb2R1bGU6c2VhcmNoQm94LnNlYXJjaEJveFZpZXdzfQogICAgICogQG1lbWJlck9mIG1vZHVsZTpzZWFyY2hCb3gKICAgICAqIEBhbGlhcyBtb2R1bGU6c2VhcmNoQm94LnNlYXJjaEJveFZpZXdzCiAgICAgKi8KICAgIGFwaS5zZWFyY2hCb3hWaWV3cyA9IHNlYXJjaEJveFZpZXdzOwogICAgLyoqCiAgICAgKiBFeHRlbmRzIHNlYXJjaCBib3ggQVBJIHdpdGgKICAgICAqIFsic2VhcmNoQm94TW9kZWxzIl17QGxpbmsgbW9kdWxlOnNlYXJjaEJveC5zZWFyY2hCb3hNb2RlbHN9CiAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOnNlYXJjaEJveAogICAgICogQGFsaWFzIG1vZHVsZTpzZWFyY2hCb3guc2VhcmNoQm94Vmlld3MKICAgICAqLwogICAgYXBpLnNlYXJjaEJveE1vZGVscyA9IHNlYXJjaEJveE1vZGVsczsKICAKICAgIHJldHVybiBhcGk7CiAgfSkoalF1ZXJ5LCBkb2N1bWVudCk7CiAgCiAgWEEucmVnaXN0ZXIoInNlYXJjaEJveCIsIFhBLmNvbXBvbmVudC5zZWFyY2guYm94KTsK
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 19167
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "ba3f86a2-4a1c-4d78-b63d-91c2779c1b5e"
  Hint: __Sortorder
  Value: 400
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160728T134136Z
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\admin
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "0d59f5dc-0339-4545-b2ff-8e9c94c2e5b7"
