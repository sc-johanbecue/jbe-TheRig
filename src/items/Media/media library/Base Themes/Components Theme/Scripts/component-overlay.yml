---
ID: "272031e0-59e4-4cf0-9eb1-3470d908c04e"
Parent: "02f3f9cf-6e2b-49c8-be56-9701c0316569"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Base Themes/Components Theme/Scripts/component-overlay"
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/272031E059E44CF09EB13470D908C04E.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "272031e0-59e4-4cf0-9eb1-3470d908c04e"
  Value: 77u/LyogZ2xvYmFsIG1lanM6ZmFsc2UgKi8NCi8qKg0KICogb3BlbiBjb250ZW50IGluIG92ZXJsYXkNCiAqIEBtb2R1bGUgb3ZlcmxheQ0KICogQHBhcmFtICB7alF1ZXJ5fSAkIEluc3RhbmNlIG9mIGpRdWVyeQ0KICogQHJldHVybiB7T2JqZWN0fSBMaXN0IG9mIG92ZXJsYXkgbWV0aG9kcw0KICovDQpYQS5jb21wb25lbnQub3ZlcmxheSA9IGZ1bmN0aW9uICgkKSB7DQogICAgLyoqDQogICAgKiBUaGlzIG9iamVjdCBzdG9yZXMgYWxsIHB1YmxpYyBhcGkgbWV0aG9kcw0KICAgICogQHR5cGUge09iamVjdC48TWV0aG9kcz59DQogICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAqICovDQogICAgdmFyIGFwaSA9IHt9LA0KICAgICAgICBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYsDQogICAgICAgIGhvc3QgPSBsb2NhdGlvbi5ob3N0LA0KICAgICAgICBsYWJlbCwNCiAgICAgICAgb3ZlcmxheVBsYWNlaG9sZGVyID0gZmFsc2UsDQogICAgICAgIG1hcmdpblRvcCA9IDEwMCwNCiAgICAgICAgZm9jdXNhYmxlRWxlbWVudHNTdHJpbmcgPSAnYVtocmVmXSwgYXJlYVtocmVmXSwgaW5wdXQ6bm90KFtkaXNhYmxlZF0pLCBzZWxlY3Q6bm90KFtkaXNhYmxlZF0pLCB0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSksIGJ1dHRvbjpub3QoW2Rpc2FibGVkXSksIGlmcmFtZSwgb2JqZWN0LCBlbWJlZCwgW3RhYmluZGV4PSIwIl0sIFtjb250ZW50ZWRpdGFibGVdJywNCiAgICAgICAgZmlyc3RUYWJTdG9wLA0KICAgICAgICBsYXN0VGFiU3RvcCwNCiAgICAgICAgb3ZlcmxheUNsaWNrU291cmNlOw0KICAgIC8qKg0KICAgICogaXNQcmV2aWV3TW9kZSBjaGVjayBpZiBwYWdlIGluIHByZXZpZXcgbW9kZQ0KICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgKiBAcHJpdmF0ZQ0KICAgICogQHJldHVybnMge0Jvb2xlYW59IGlzIHBhZ2UgaW4gYSBwcmV2aWV3IG1vZGUNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGlzUHJldmlld01vZGUoKSB7DQogICAgICAgIGlmIChocmVmLmluZGV4T2YoInNjX21vZGU9cHJldmlldyIpID4gLTEpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHZhciAkaGRQYWdlTW9kZSA9ICQoJyNoZFBhZ2VNb2RlJyk7DQoNCiAgICAgICAgcmV0dXJuICRoZFBhZ2VNb2RlLmxlbmd0aCA+IDAgJiYgJGhkUGFnZU1vZGUuYXR0cigndmFsdWUnKSA9PSAncHJldmlldyc7DQogICAgfQ0KICAgIC8qKg0KICAgICogaXNFZGl0TW9kZSBjaGVjayBpZiBwYWdlIGluIGVkaXQgbW9kZQ0KICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgKiBAcHJpdmF0ZQ0KICAgICogQHJldHVybnMge0Jvb2xlYW59IGlzIHBhZ2UgaW4gYSBlZGl0IG1vZGUNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGlzRWRpdE1vZGUoKSB7DQogICAgICAgIGlmIChocmVmLmluZGV4T2YoInNjX21vZGU9ZWRpdCIpID4gLTEpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHZhciAkaGRQYWdlTW9kZSA9ICQoJyNoZFBhZ2VNb2RlJyk7DQoNCiAgICAgICAgcmV0dXJuICRoZFBhZ2VNb2RlLmxlbmd0aCA+IDAgJiYgJGhkUGFnZU1vZGUuYXR0cigndmFsdWUnKSA9PSAnZWRpdCc7DQogICAgfQ0KICAgIC8qKg0KICAgICAqIGlzT3ZlcmxheVBhZ2UgY2hlY2sgaWYgIiN3cmFwcGVyIiBlbGVtZW50IGhhcyBjbGFzcyAib3ZlcmxheS1wYWdlIg0KICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICAqIEBwcml2YXRlDQogICAgICogQHJldHVybnMge0Jvb2xlYW59IGlzICN3cmFwcGVyIGFuIG92ZXJsYXkgcGFnZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGlzT3ZlcmxheVBhZ2UoKSB7DQogICAgICAgIHJldHVybiAkKCcjd3JhcHBlcicpLmhhc0NsYXNzKCdvdmVybGF5LXBhZ2UnKTsNCiAgICB9DQogICAgLyoqDQogICAgICogaGFzT3ZlcmxheUNvbnRlbnQgY2hlY2sgaWYgIm92ZXJsYXktc291cmNlIiANCiAgICAgKiBlbGVtZW50IHByZXNlbnQgb24gYSBwYWdlDQogICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgICogQHByaXZhdGUNCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gaXMgb3ZlcmxheS1zb3VyY2UgcHJlc2VudCBvbiBhIHBhZ2UNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBoYXNPdmVybGF5Q29udGVudCgpIHsNCiAgICAgICAgcmV0dXJuICQoIi5vdmVybGF5LXNvdXJjZSIpLmxlbmd0aDsNCiAgICB9DQogICAgLyoqDQogICAgKiByZXNpemVPdmVybGF5IHJlc2l6ZSBvdmVybGF5DQogICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAqIEBwYXJhbSB7alF1ZXJ5PE9iamVjdD59IGlubmVyICIub3ZlcmxheS1pbm5lciINCiAgICAqIEBwYXJhbSB7alF1ZXJ5PE9iamVjdD59IGNvbnRlbnQgKCIuY29tcG9uZW50LWNvbnRlbnQiKSwNCiAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIGNvbnRhaW5zIHNpemUgb2Ygb3ZlcmxheSANCiAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aF0gd2lkdGggb2Ygb3ZlcmxheQ0KICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmhlaWdodF0gaGVpZ2h0IG9mIG92ZXJsYXkNCiAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5wZXJjZW50XSB1bml0cyBvZiB3aWR0aCBhbmQgaGVpZ2h0DQogICAgKiBAYWxpYXMgbW9kdWxlOm92ZXJsYXkucmVzaXplT3ZlcmxheQ0KICAgICovDQogICAgYXBpLnJlc2l6ZU92ZXJsYXkgPSBmdW5jdGlvbiAoaW5uZXIsIGNvbnRlbnQsIG9wdGlvbnMpIHsNCiAgICAgICAgdmFyIHVuaXQgPSAicHgiOw0KICAgICAgICB2YXIgY3NzID0gew0KICAgICAgICAgICAgIndpZHRoIjogIiIsDQogICAgICAgICAgICAiaGVpZ2h0IjogIiINCiAgICAgICAgfTsNCiAgICAgICAgdmFyIHdoID0gJCh3aW5kb3cpLmhlaWdodCgpOw0KDQogICAgICAgIGlmIChvcHRpb25zLnBlcmNlbnQpIHsNCiAgICAgICAgICAgIHVuaXQgPSAiJSI7DQogICAgICAgICAgICBpbm5lci5hZGRDbGFzcygib3ZlcmxheS1wZXJjZW50Iik7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpbm5lci5yZW1vdmVDbGFzcygib3ZlcmxheS1wZXJjZW50Iik7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAob3B0aW9ucy53aWR0aCkgew0KICAgICAgICAgICAgY3NzWyJ3aWR0aCJdID0gb3B0aW9ucy53aWR0aCArIHVuaXQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKG9wdGlvbnMuaGVpZ2h0KSB7DQogICAgICAgICAgICBjc3NbImhlaWdodCJdID0gb3B0aW9ucy5oZWlnaHQgKyB1bml0Ow0KICAgICAgICB9DQoNCiAgICAgICAgY3NzWyJtYXgtaGVpZ2h0Il0gPSAod2ggLSBtYXJnaW5Ub3AgLSAwLjEgKiB3aCkgKyAicHgiOw0KDQogICAgICAgIGNvbnRlbnQuY3NzKGNzcyk7DQogICAgfQ0KICAgIC8qKg0KICAgICogZ2V0VXJsVmFyaWFibGVzIGdldCB2YXJpYWJsZXMgcHJvdmlkZWQgaW4gb3ZlcmxheSB1cmwNCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCB1cmwgb2Ygb3ZlcmxheSBjb250ZW50DQogICAgKiBAcHJpdmF0ZQ0KICAgICogQHJldHVybnMge09iamVjdH0gbGlzdCBvZiBnZXQgcGFyYW1ldGVycw0KICAgICovDQogICAgZnVuY3Rpb24gZ2V0VXJsVmFyaWFibGVzKHVybCkgew0KICAgICAgICB2YXIgcSA9IHVybC5zcGxpdCgnPycpWzFdLA0KICAgICAgICAgICAgdmFycyA9IFtdLA0KICAgICAgICAgICAgaGFzaDsNCg0KICAgICAgICBpZiAocSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHEgPSBxLnNwbGl0KCcmJyk7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBoYXNoID0gcVtpXS5zcGxpdCgnPScpOw0KICAgICAgICAgICAgICAgIHZhcnMucHVzaChoYXNoWzFdKTsNCiAgICAgICAgICAgICAgICB2YXJzW2hhc2hbMF1dID0gaGFzaFsxXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB2YXJzOw0KICAgIH0NCiAgICAvKioNCiAgICAqIGdldFNpemUgY2hlY2sgaWYgb3ZlcmxheSBoYXMgd2lkdGggb3IgaGVpZ2h0IGluIHVybCANCiAgICAqIGFuZCBzZXQgdXAgdGhpcyB2YWx1ZXMgIA0KICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgKiBAcGFyYW0ge1N0cmluZ30gdmFycyB2YXJpYWJsZXMgZnJvbSB1cmwgb2Ygb3ZlcmxheSBjb250ZW50DQogICAgKiBAcHJpdmF0ZQ0KICAgICogQHJldHVybnMge09iamVjdH0gc2l6ZXMgb2Ygb3ZlcmxheQ0KICAgICovDQogICAgZnVuY3Rpb24gZ2V0U2l6ZSh2YXJzKSB7DQogICAgICAgIHZhciBvYmogPSB7fTsNCg0KICAgICAgICBpZiAodmFyc1sid2lkdGgiXSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgb2JqWyJ3aWR0aCJdID0gdmFyc1sid2lkdGgiXTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh2YXJzWyJoZWlnaHQiXSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgb2JqWyJoZWlnaHQiXSA9IHZhcnNbImhlaWdodCJdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG9iajsNCiAgICB9DQogICAgLyoqDQogICAgKiBjaGVja0ludGVybmFsIGNoZWNrcyBpZiBvdmVybGF5IGNvbnRlbnQgaXMgaW50ZXJuYWwgcmVzb3VyY2UNCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCB1cmwgb2Ygb3ZlcmxheSBjb250ZW50DQogICAgKiBAcHJpdmF0ZQ0KICAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgLSBjb250ZW50IGlzIGludGVybmFsfCBmYWxzZSAtIGNvbnRlbnQgaXMgZXh0ZXJuYWwNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGNoZWNrSW50ZXJuYWwodXJsKSB7DQogICAgICAgIGlmICh1cmwuaW5kZXhPZihob3N0KSA+IC0xKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIC8qKg0KICAgICogY2hlY2tJbWFnZSBjaGVja3MgaWYgb3ZlcmxheSBjb250ZW50IGlzIGFuIGltYWdlDQogICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgdXJsIG9mIG92ZXJsYXkgY29udGVudA0KICAgICogQHByaXZhdGUNCiAgICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIC0gY29udGVudCBpcyBhbiBpbWFnZXwgZmFsc2UgLSBjb250ZW50IG5vdCBhbiBhIGltYWdlDQogICAgKi8NCiAgICBmdW5jdGlvbiBjaGVja0ltYWdlKHVybCkgew0KICAgICAgICB2YXIgZXh0ID0gdXJsLnNwbGl0KCI/IilbMF0uc3BsaXQoJy4nKS5wb3AoKTsNCiAgICAgICAgaWYgKCQuaW5BcnJheShleHQsIFsnZ2lmJywgJ3BuZycsICdqcGcnLCAnanBlZyddKSA+IC0xKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIGxvYWRPdmVybGF5IGNyZWF0ZXMgb3ZlcmxheSBjb250ZW50IGFuZCBzaG93IGl0DQogICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgdXJsIG9mIG92ZXJsYXkNCiAgICAqIEBwYXJhbSB7alF1ZXJ5PERPTUVsZW1lbnQ+fSBvdmVybGF5IG92ZXJsYXkgRE9NRWxlbWVudA0KICAgICogQHByaXZhdGUNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGxvYWRPdmVybGF5KHVybCwgb3ZlcmxheSkgew0KICAgICAgICB2YXIgY29udGVudCA9IG92ZXJsYXkuZmluZCgiLm92ZXJsYXktaW5uZXIiKSwNCiAgICAgICAgICAgIG92ZXJsYXlDb250ZW50ID0gb3ZlcmxheS5maW5kKCIuY29tcG9uZW50LWNvbnRlbnQiKSwNCiAgICAgICAgICAgIHZhcnMgPSBnZXRVcmxWYXJpYWJsZXModXJsKSwNCiAgICAgICAgICAgIGludGVybmFsTGluayA9IGNoZWNrSW50ZXJuYWwodXJsKSwNCiAgICAgICAgICAgIG92ZXJsYXlTaXplID0gZ2V0U2l6ZSh2YXJzKSwNCiAgICAgICAgICAgIHN1ZmZpeDsNCiAgICAgICAgb3ZlcmxheUNvbnRlbnQuYWRkQ2xhc3MoJ292ZXJsYXlGdWxsV2lkdGgnKTsNCiAgICAgICAgY29udGVudC5yZW1vdmVBdHRyKCdzdHlsZScpOw0KICAgICAgICBpZiAoaW50ZXJuYWxMaW5rKSB7DQogICAgICAgICAgICBpZiAoY2hlY2tJbWFnZSh1cmwpKSB7DQogICAgICAgICAgICAgICAgY29udGVudC5lbXB0eSgpLmFwcGVuZCgkKCI8aW1nPiIsIHsgc3JjOiB1cmwgfSkpOw0KICAgICAgICAgICAgICAgIGNvbnRlbnQuY3NzKG92ZXJsYXlTaXplKTsNCiAgICAgICAgICAgICAgICBvdmVybGF5Q29udGVudC5yZW1vdmVDbGFzcygnb3ZlcmxheUZ1bGxXaWR0aCcpOw0KICAgICAgICAgICAgICAgIHNob3dPdmVybGF5KG92ZXJsYXkpOw0KICAgICAgICAgICAgfSBlbHNlIGlmICh1cmwuaW5kZXhPZigib3ZlcmxheXR5cGU9aWZyYW1lIikgPiAtMSkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQuZW1wdHkoKS5hcHBlbmQoJCgiPGlmcmFtZT4iLCB7IHNyYzogdXJsLCBzdHlsZTogIndpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCUiIH0pKTsNCiAgICAgICAgICAgICAgICBjb250ZW50LmNzcyhvdmVybGF5U2l6ZSk7DQogICAgICAgICAgICAgICAgc2hvd092ZXJsYXkob3ZlcmxheSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChpc1ByZXZpZXdNb2RlKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgc3VmZml4ID0gImNmX292ZXJsYXk9MSI7DQogICAgICAgICAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKCJzaXRlY29yZS9zaGVsbC8iKTsNCiAgICAgICAgICAgICAgICAgICAgdXJsICs9ICh1cmwuaW5kZXhPZigiPyIpID09IC0xID8gIj8iIDogIiYiKSArIHN1ZmZpeDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkLmdldCh1cmwsIGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBvdmVybGF5RGF0YSA9ICQoZGF0YSkuYmVmb3JlKCkuZmlyc3QoKTsNCg0KICAgICAgICAgICAgICAgICAgICBhcGkucmVzaXplT3ZlcmxheShjb250ZW50LCBvdmVybGF5Q29udGVudCwgew0KICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IG92ZXJsYXlEYXRhLmF0dHIoImRhdGEtd2lkdGgiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogb3ZlcmxheURhdGEuZGF0YSgiaGVpZ2h0IiksDQogICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiBvdmVybGF5RGF0YS5kYXRhKCJwZXJjZW50IikNCiAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgY29udGVudC5lbXB0eSgpLmFwcGVuZChkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgWEEuaW5pdCgpOw0KICAgICAgICAgICAgICAgICAgICBzaG93T3ZlcmxheShvdmVybGF5KTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChjaGVja0ltYWdlKHVybCkpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50LmVtcHR5KCkuYXBwZW5kKCQoIjxpbWc+IiwgeyBzcmM6IHVybCB9KSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNvbnRlbnQuZW1wdHkoKS5hcHBlbmQoJCgiPGlmcmFtZSA+IiwgeyBzcmM6IHVybCwgc3R5bGU6ICJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlIiB9KSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb250ZW50LmNzcyhvdmVybGF5U2l6ZSk7DQogICAgICAgICAgICBzaG93T3ZlcmxheShvdmVybGF5KTsNCiAgICAgICAgfQ0KDQogICAgfQ0KICAgIC8qKg0KICAgICogcHJlU2hvd092ZXJsYXkgc2V0cyBvcGFjaXR5IHRvIDEgYW5kIHNob3dzIG92ZXJsYXkNCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICogQHBhcmFtIHtqUXVlcnk8RE9NRWxlbWVudD59IG92ZXJsYXkgb3ZlcmxheSBET01FbGVtZW50DQogICAgKiBAcHJpdmF0ZQ0KICAgICovDQogICAgZnVuY3Rpb24gcHJlU2hvd092ZXJsYXkob3ZlcmxheSkgew0KICAgICAgICBvdmVybGF5LmNzcyh7DQogICAgICAgICAgICAib3BhY2l0eSI6IDENCiAgICAgICAgfSkuc2hvdygpOw0KICAgIH0NCiAgICAvKioNCiAgICAqIHNob3dPdmVybGF5IG1ha2VzIG92ZXJsYXkgdmlzaWJsZQ0KICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgKiBAcGFyYW0ge2pRdWVyeTxET01FbGVtZW50Pn0gb3ZlcmxheSBvdmVybGF5IERPTUVsZW1lbnQNCiAgICAqIEBwcml2YXRlDQogICAgKiBAcmV0dXJucyB7alF1ZXJ5PERPTUVsZW1lbnQ+fSBvdmVybGF5IG92ZXJsYXkgRE9NRWxlbWVudA0KICAgICovDQoNCiAgICBmdW5jdGlvbiBzaG93T3ZlcmxheShvdmVybGF5KSB7DQogICAgICAgIHZhciBjbG9zZSwgY29udGVudDsNCg0KICAgICAgICBvdmVybGF5LnNob3coKS5hbmltYXRlKHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDENCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8gaGlkZXMgd3JhcHBlciBkYXRhIGZyb20gc2NyZWVuIHJlYWRlcnMNCiAgICAgICAgJCgiI3dyYXBwZXIiKS5hZGRDbGFzcygiYXJpYS1oaWRkZW4iKTsNCg0KICAgICAgICBvdmVybGF5Q2xpY2tTb3VyY2UgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50Ow0KDQogICAgICAgIGNsb3NlID0gb3ZlcmxheS5maW5kKCIub3ZlcmxheS1jbG9zZSIpOw0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgY2xvc2UuZm9jdXMoKTsgfSwgMCk7DQoNCiAgICAgICAgY29udGVudCA9IG92ZXJsYXkuZmluZCgiLm92ZXJsYXktaW5uZXIiKTsNCiAgICAgICAgY29udGVudC5ibHVyKGZ1bmN0aW9uIChhcmdzKSB7DQogICAgICAgICAgICBhcmdzLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBhcmdzLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGNsb3NlLmZvY3VzKCkgfSwgMCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIEZpbmRzIGFsbCBmb2N1c2FibGUgY2hpbGRyZW4NCiAgICAgICAgdmFyIGZvY3VzYWJsZUVsZW1lbnRzID0gY29udGVudC5maW5kKGZvY3VzYWJsZUVsZW1lbnRzU3RyaW5nKTsNCg0KICAgICAgICAvLyBDb252ZXJ0cyBOb2RlTGlzdCB0byBBcnJheQ0KICAgICAgICBmb2N1c2FibGVFbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZvY3VzYWJsZUVsZW1lbnRzKTsNCiAgICAgICAgZmlyc3RUYWJTdG9wID0gZm9jdXNhYmxlRWxlbWVudHNbMF07DQogICAgICAgIGxhc3RUYWJTdG9wID0gZm9jdXNhYmxlRWxlbWVudHNbZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoIC0gMV07DQoNCiAgICAgICAgLy8gRm9jdXMgZmlyc3QNCiAgICAgICAgZmlyc3RUYWJTdG9wLmZvY3VzKCk7DQoNCiAgICAgICAgaWYgKGlzUHJldmlld01vZGUoKSB8fCBpc0VkaXRNb2RlKCkpIHsNCiAgICAgICAgICAgIG92ZXJsYXkuZmluZCgnPiAuY29tcG9uZW50LWNvbnRlbnQnKS5jc3Moew0KICAgICAgICAgICAgICAgIHRvcDogMjAwLA0KICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZSgtNTAlLCAwKScNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG92ZXJsYXk7DQogICAgfQ0KICAgIC8qKg0KICAgICAqIGhpZGVPdmVybGF5IGhpZGUgb3ZlcmxheQ0KICAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICAqIEBwcml2YXRlDQogICAgICovDQogICAgZnVuY3Rpb24gaGlkZU92ZXJsYXkob3ZlcmxheSkgew0KICAgICAgICAkKCIjd3JhcHBlciIpLnJlbW92ZUNsYXNzKCJhcmlhLWhpZGRlbiIpOw0KICAgICAgICB2YXIgY29udGVudCA9IG92ZXJsYXkuZmluZCgiLm92ZXJsYXktaW5uZXIiKTsNCg0KICAgICAgICBvdmVybGF5LmFuaW1hdGUoeyBvcGFjaXR5OiAwIH0sDQogICAgICAgICAgICBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgb3ZlcmxheS5oaWRlKCk7DQogICAgICAgICAgICAgICAgY29udGVudC5lbXB0eSgpOw0KDQogICAgICAgICAgICAgICAgaWYgKG1lanMpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBtZWpzLnBsYXllcnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKCIjIiArIG1lanMucGxheWVyc1twXS5pZCkucGFyZW50cygiLm92ZXJsYXkiKS5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiMiICsgbWVqcy5wbGF5ZXJzW3BdLmlkICsgJyB2aWRlbycpLmF0dHIoJ3NyYycsICcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWpzLnBsYXllcnNbcF0ucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVqcy5wbGF5ZXJzLnNwbGljZShwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgKTsNCg0KICAgICAgICByZXR1cm4gb3ZlcmxheTsNCiAgICB9DQogICAgLyoqDQogICAgICogY3JlYXRlT3ZlcmxheSBjcmVhdGVzIGEgbWFya3VwIGZvciBvdmVybGF5IGFuZCBhcHBlbmRzIGl0IHRvIGJvZHkgDQogICAgICogQG1lbWJlck9mIG1vZHVsZTpvdmVybGF5DQogICAgICogQHByaXZhdGUNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBjcmVhdGVPdmVybGF5KCkgew0KICAgICAgICB2YXIgb3ZlcmxheSA9ICI8ZGl2IGNsYXNzPSdvdmVybGF5LXdyYXBwZXInPiIgKw0KICAgICAgICAgICAgIjxkaXYgY2xhc3M9J292ZXJsYXkgY29tcG9uZW50Jz4iICsNCiAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdjb21wb25lbnQtY29udGVudCcgcm9sZT0nZGlhbG9nJz4iICsNCiAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdvdmVybGF5LWlubmVyJz48L2Rpdj4iICsNCiAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdvdmVybGF5LWNsb3NlJyByb2xlPSdidXR0b24nIGFyaWEtbGFiZWw9J0Nsb3NlIGRpYWxvZyc+PC9kaXY+IiArDQogICAgICAgICAgICAiPC9kaXY+IiArDQogICAgICAgICAgICAiPC9kaXY+IiArDQogICAgICAgICAgICAiPC9kaXY+IjsNCg0KICAgICAgICAkKCJib2R5IikuYXBwZW5kKG92ZXJsYXkpOw0KICAgIH0NCiAgICAvKioNCiAgICAgKiBJbml0IGZvcm0gY29uZGl0aW9ucyB1bmRlciBvdmVybGF5IGNvbnRlbnQNCiAgICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGluaXRGb3JtQ29uZGl0aW9ucygpIHsNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAod2luZG93LiQgJiYgd2luZG93LiQuZm4uaW5pdF9mb3JtQ29uZGl0aW9ucykgew0KICAgICAgICAgICAgICAgIHZhciBmb3JtcyA9IHdpbmRvdy4kKCIub3ZlcmxheS1pbm5lciBmb3JtW2RhdGEtc2MtZnhiXSIpOw0KICAgICAgICAgICAgICAgIGlmIChmb3Jtcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybXMuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybUVsID0gd2luZG93LiQodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbUluaXRpYWxpemVyID0gd2luZG93LiQuZm4uaW5pdF9mb3JtQ29uZGl0aW9ucy5iaW5kKGZvcm1FbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmcm9tSW5pdGlhbGl6ZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSkucGFyZW50KCkub24oInN1Ym1pdCIsICJmb3JtW2RhdGEtc2MtZnhiXSIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkc3VibWl0QnRucyA9IHdpbmRvdy4kKHRoaXMpLmZpbmQoImlucHV0W3R5cGU9J3N1Ym1pdCddLCBidXR0b25bdHlwZT0nc3VibWl0J10iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc3VibWl0QnRucy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3VibWl0QnRucy5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCAwKQ0KDQogICAgfQ0KDQogICAgLyoqDQogICAgKiBpbml0SW5zdGFuY2UgbWV0aG9kIHByZXZlbnQgZXZlbnQgcHJvcGFnYXRpb24gYW5kIGNhbGwgDQogICAgKiBbInByZVNob3dPdmVybGF5Il17QGxpbmsgbW9kdWxlOm92ZXJsYXkucHJlU2hvd092ZXJsYXl9IGFuZA0KICAgICogWyJsb2FkT3ZlcmxheSJde0BsaW5rIG1vZHVsZTpvdmVybGF5LmxvYWRPdmVybGF5fSBtZXRob2RzDQogICAgKiBAbWVtYmVyT2YgbW9kdWxlOm92ZXJsYXkNCiAgICAqIEBtZXRob2QNCiAgICAqIEBwYXJhbSB7alF1ZXJ5fSBjb21wb25lbnQgUm9vdCBET00gZWxlbWVudCBvZiBhcmNoaXZlIGNvbXBvbmVudCB3cmFwcGVkIGJ5IGpRdWVyeQ0KICAgICogQHBhcmFtIHtqUXVlcnk8RE9NRWxlbWVudD59IG92ZXJsYXkgb3ZlcmxheSBET01FbGVtZW50DQogICAgKiBAcGFyYW0ge2pRdWVyeTxET01FbGVtZW50Pn0gb3ZlcmxheUNvbnRlbnQgb3ZlcmxheSBjb250ZW50IERPTUVsZW1lbnQgDQogICAgKiBAYWxpYXMgbW9kdWxlOm92ZXJsYXkuaW5pdEluc3RhbmNlDQogICAgKi8NCiAgICBhcGkuaW5pdEluc3RhbmNlID0gZnVuY3Rpb24gKGNvbXBvbmVudCwgb3ZlcmxheSwgb3ZlcmxheUNvbnRlbnQpIHsNCiAgICAgICAgY29tcG9uZW50Lm9uKCJjbGljayIsDQogICAgICAgICAgICBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIHByZVNob3dPdmVybGF5KG92ZXJsYXksIG92ZXJsYXlDb250ZW50KTsNCg0KICAgICAgICAgICAgICAgIHZhciB1cmkgPSB0aGlzLmhyZWY7DQogICAgICAgICAgICAgICAgbG9hZE92ZXJsYXkodXJpLCBvdmVybGF5KTsNCg0KICAgICAgICAgICAgICAgIHZhciBocmVmID0gdGhpcy5ocmVmLnNwbGl0KCcvJyk7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gaHJlZi5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGhyZWYucG9wKCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChsYWJlbC5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIC8vIEluaXQgZm9ybXMgaWYgdGhleSBleGlzdCBpbnNpZGUgb3ZlcmxheQ0KICAgICAgICBpbml0Rm9ybUNvbmRpdGlvbnMoKTsNCiAgICAgICAgY29tcG9uZW50LmFkZENsYXNzKCJpbml0aWFsaXplZCIpOw0KICAgIH0NCiAgICAvKioNCiAgICAqIGluaXQgbWV0aG9kIG1ha2VzIHByZXBhcmF0aW9uIGZvciBvdmVybGF5IGNvbnRlbnQsIGJpbmRzIGV2ZW50cw0KICAgICogZm9yIHByb3BlciB3b3JrIG9mIG92ZXJsYXkgYW5kDQogICAgKiBjYWxscyBpbiBhIGxvb3AgZm9yIGVhY2ggaW5zdGFuY2Ugb2Ygb3ZlcmxheQ0KICAgICogWyIuaW5pdEluc3RhbmNlIl17QGxpbmsgbW9kdWxlOkFjY29yZGlvbi5pbml0SW5zdGFuY2V9IG1ldGhvZC4NCiAgICAqIEBtZW1iZXJPZiBtb2R1bGU6b3ZlcmxheQ0KICAgICogQGFsaWFzIG1vZHVsZTpvdmVybGF5LmluaXQNCiAgICAqLw0KICAgIGFwaS5pbml0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgb3ZlcmxheUNvbnRlbnQsDQogICAgICAgICAgICBvdmVybGF5U291cmNlLA0KICAgICAgICAgICAgb3ZlcmxheUlubmVyLA0KICAgICAgICAgICAgb3ZlcmxheUNsb3NlTGluaywNCiAgICAgICAgICAgIGNsb3NlQWN0aW9uLA0KICAgICAgICAgICAgcGFnZSwNCiAgICAgICAgICAgIG92ZXJsYXksDQogICAgICAgICAgICBjb250ZW50Ow0KDQogICAgICAgIGlmICghb3ZlcmxheVBsYWNlaG9sZGVyICYmIGhhc092ZXJsYXlDb250ZW50KCkpIHsNCiAgICAgICAgICAgIGNyZWF0ZU92ZXJsYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc092ZXJsYXlQYWdlKCkpIHsNCg0KICAgICAgICAgICAgcGFnZSA9ICQoIi5vdmVybGF5LXBhZ2UiKTsNCiAgICAgICAgICAgIG92ZXJsYXlDb250ZW50ID0gcGFnZS5jaGlsZHJlbigiLmNvbXBvbmVudC1jb250ZW50Iik7DQogICAgICAgICAgICBvdmVybGF5ID0gJCgiI3Nwbk92ZXJsYXkiKTsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBvdmVybGF5Q29udGVudC5jaGlsZHJlbigiLm92ZXJsYXktaW5uZXIiKTsNCg0KICAgICAgICAgICAgYXBpLnJlc2l6ZU92ZXJsYXkoY29udGVudCwgb3ZlcmxheUNvbnRlbnQsIHsNCiAgICAgICAgICAgICAgICB3aWR0aDogb3ZlcmxheUNvbnRlbnQuZGF0YSgid2lkdGgiKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IG92ZXJsYXlDb250ZW50LmRhdGEoImhlaWdodCIpLA0KICAgICAgICAgICAgICAgIHBlcmNlbnQ6IG92ZXJsYXlDb250ZW50LmRhdGEoInBlcmNlbnQiKQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBvdmVybGF5Q29udGVudC5vbigiY2xpY2siLCBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LnR5cGUgIT0gJ3N1Ym1pdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBwYWdlLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNQcmV2aWV3TW9kZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoInNjX21vZGU9cHJldmlldyIsICJzY19tb2RlPWVkaXQiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICBvdmVybGF5ID0gJCgiLm92ZXJsYXktd3JhcHBlciA+IC5vdmVybGF5Iik7DQogICAgICAgIG92ZXJsYXlDb250ZW50ID0gb3ZlcmxheS5maW5kKCIuY29tcG9uZW50LWNvbnRlbnQiKTsNCiAgICAgICAgb3ZlcmxheVNvdXJjZSA9ICQoIi5vdmVybGF5LXNvdXJjZSBhOm5vdCguaW5pdGlhbGl6ZWQpLCBhLm92ZXJsYXktc291cmNlOm5vdCguaW5pdGlhbGl6ZWQpIik7DQogICAgICAgIG92ZXJsYXlJbm5lciA9ICQoIi5vdmVybGF5LWlubmVyIik7DQogICAgICAgIG92ZXJsYXlDbG9zZUxpbmsgPSBvdmVybGF5LmZpbmQoIi5vdmVybGF5LWNsb3NlIik7DQoNCiAgICAgICAgY2xvc2VBY3Rpb24gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBoaWRlT3ZlcmxheShvdmVybGF5KTsNCiAgICAgICAgICAgIG92ZXJsYXlJbm5lci5vZmYoImJsdXIiKTsNCiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmIChvdmVybGF5Q2xpY2tTb3VyY2UgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBvdmVybGF5Q2xpY2tTb3VyY2UuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCAwKTsNCiAgICAgICAgfTsNCg0KICAgICAgICBpZiAoIW92ZXJsYXlQbGFjZWhvbGRlcikgew0KICAgICAgICAgICAgb3ZlcmxheUNvbnRlbnQub24oImNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC50eXBlICE9ICdzdWJtaXQnKSB7DQogICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBvdmVybGF5Lm9uKCJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQudHlwZSAhPSAnc3VibWl0Jykgew0KICAgICAgICAgICAgICAgICAgICBjbG9zZUFjdGlvbigpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIG92ZXJsYXlDbG9zZUxpbmsub24oImNsaWNrIiwgZnVuY3Rpb24gKGFyZ3MpIHsNCiAgICAgICAgICAgICAgICBhcmdzLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgY2xvc2VBY3Rpb24oKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAkKCJib2R5Iikua2V5ZG93bihmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBUQUIga2V5IHByZXNzDQogICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gOSkgew0KICAgICAgICAgICAgICAgICAgICAvLyBTSElGVCArIFRBQg0KICAgICAgICAgICAgICAgICAgICBpZiAoZS5zaGlmdEtleSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGZpcnN0VGFiU3RvcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0VGFiU3RvcC5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBUQUINCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBsYXN0VGFiU3RvcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmlyc3RUYWJTdG9wLmF0dHIoJ3RhYmluZGV4JywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFRhYlN0b3AuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEVTQ0FQRQ0KICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDI3KSB7DQogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgIGNsb3NlQWN0aW9uKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICQod2luZG93KS5vbigicmVzaXplIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0IC0gbWFyZ2luVG9wIC0gMC4xICogaGVpZ2h0Ow0KICAgICAgICAgICAgICAgIG92ZXJsYXlDb250ZW50LmNzcygibWF4LWhlaWdodCIsIGhlaWdodCArICJweCIpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIG92ZXJsYXlQbGFjZWhvbGRlciA9IHRydWU7DQogICAgICAgIH0NCg0KDQogICAgICAgIG92ZXJsYXlTb3VyY2UuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBhcGkuaW5pdEluc3RhbmNlKCQodGhpcyksIG92ZXJsYXksIG92ZXJsYXlDb250ZW50KTsNCiAgICAgICAgfSk7DQoNCg0KICAgIH07DQoNCiAgICByZXR1cm4gYXBpOw0KDQp9KGpRdWVyeSk7DQoNClhBLnJlZ2lzdGVyKCJvdmVybGF5IiwgWEEuY29tcG9uZW50Lm92ZXJsYXkpOw0KDQoNCltdLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VhcmNoLXJlc3VsdHMub3ZlcmxheS1zb3VyY2UnKSwgZnVuY3Rpb24gKGUpIHsNCiAgICBYQS5kb20ub2JzZXJ2ZURPTShlLCBmdW5jdGlvbiAoKSB7IFhBLmNvbXBvbmVudC5vdmVybGF5LmluaXQoKTsgfSk7DQp9KTs=
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 17900
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20180226T092726Z
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "c23a2cd3-55b6-4b17-b37e-1b7faaf51e64"
